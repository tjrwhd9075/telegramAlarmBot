import requests
from bs4 import BeautifulSoup
import re

def search(area):
    session = requests.Session() 
    addr = "https://weather.naver.com/today/"
    map_cityNum = {     # ì§€ì—­ ë²ˆí˜¸ ë§¤í•‘
                'ê°€í‰':"001001", 'ê°•í™”':"001002", 'ê³ ì–‘':"001003", 'ê³¼ì²œ':'001004','ê´‘ëª…':"001005" , 
                'ê´‘ì£¼ì‹œ':"001006", 'êµ¬ë¦¬':"001007", 'êµ°í¬':"001008", 'ê¹€í¬':"001009", 'ë‚¨ì–‘ì£¼':"001010",
                'ë™ë‘ì²œ':"001011", 'ë¬¸ì‚°':"001035", 'ë¶€ì²œ':"001012", 'ì„œìš¸':"001013", 'ì„±ë‚¨':'001014',
                'ìˆ˜ì›':"001015", 'ì‹œí¥':"001016", 'ì‹ ê°ˆ':"001034", 'ì•ˆì‚°':"001017", 'ì•ˆì„±':'001018',
                'ì•ˆì–‘':"001019", 'ì–‘ì£¼':"001020", 'ì–‘í‰':"001021", 'ì—¬ì£¼':"001036", 'ì—°ì²œ':"001022", 
                'ì˜¤ì‚°':"001023", 'ìš©ì¸':"001024", 'ì˜ì™•':"001025", 'ì˜ì •ë¶€':"001026", 'ì´ì²œ':"001027", 
                'ì¸ì²œ':"001028", 'íŒŒì£¼':"001029", 'í‰íƒ':"001030", 'í¬ì²œ':"001031", 'í•˜ë‚¨':"001032", 'í™”ì„±':"001033",

                'ë°±ë ¹ë„':"002001", 'ì†Œì²­ë„':"002002", 'ì—°í‰ë„':"002003",

                'ì–‘êµ¬':"003001", 'ì˜ì›”':"003002", 'ì›ì£¼':"003003", 'ì¸ì œ':"003004", 'ì •ì„ ':"003005", 
                'ì² ì›':"003006", 'ì¶˜ì²œ':"003007", 'í‰ì°½':"003008", 'í™ì²œ':"003009", 'í™”ì²œ':"003010", 
                'íš¡ê³„':"003012", 'íš¡ì„±':"003011",
                
                'ê°•ë¦‰':"004001", 'ê°•ì›':"004002", 'ì‚°ê°„':"004003", 'ê³ ì„±':"004004", 'ëŒ€ê´€ë ¹':"004005", 
                'ë™í•´':"004006", 'ì‚¼ì²™':"004007", 'ìƒˆë§':"004011", 'ì†ì´ˆ':"004007", 'ì–‘ì–‘':"004008", 
                'íƒœë°±':"004009",

                'ê´´ì‚°':"005001", 'ë‚¨ì´':"005013", 'ë‹¨ì–‘':"005002", 'ë³´ì€':"005003", 'ì˜ë™':"005004", 
                'ì˜¥ì²œ':"005005", 'ìŒì„±':"005006", 'ì œì²œ':"005007", 'ì¦í‰':"005008", 'ì§„ì²œ':"005009", 
                'ì²­ì›':"005014", 'ì²­ì£¼':"005010", 'ì¶”í’ë ¹':"005011", 'ì¶©ì£¼':"005012",

                'ê³„ë£¡':"006016", 'ê³µì£¼':"006001", 'ê¸ˆì‚°':"006002", 'ë…¼ì‚°':"006003", 'ë‹¹ì§„':"006004", 
                'ëŒ€ì „':"006005", 'ë³´ë ¹':"006006", 'ë¶€ì—¬':"006007", 'ì„œì‚°':"006008", 'ì„œì²œ':"006009", 
                'ì„¸ì¢…':"006017", 'ì•„ì‚°':"006010", 'ì˜ˆì‚°':"006011", 'ì²œì•ˆ':"006012", 'ì²­ì–‘':"006013", 
                'íƒœì•ˆ':"006014", 'í™ì„±':"006015",

                'ê²½ì‚°':"007001", 'ê²½ì£¼':"007002", 'ê³ ë ¹':"007003", 'êµ¬ë¯¸':"007004", 'êµ°ìœ„':"007005", 
                'ê¹€ì²œ':"007006", 'ëŒ€êµ¬':"007007", 'ë¬¸ê²½':"007008", 'ë´‰í™”':"007009", 'ìƒì£¼':"007010", 
                'ì„±ì£¼':"007011", 'ì•ˆë™':"007012", 'ì˜ë•':"007013", 'ì˜ì–‘':"007014", 'ì˜ì£¼':"007015", 
                'ì˜ì²œ':"007016", 'ì˜ˆì²œ':"007017", 'ìš¸ì§„':"007018", 'ì˜ì„±':"007019", 'ì²­ë„':"007020", 
                'ì²­ì†¡':"007021", 'ì¹ ê³¡':"007022", 'í¬í•­':"007023",

                'ê±°ì œ':"008001", 'ê±°ì°½':"008002", 'ê³ ì„±':"008003", 'ê¹€í•´':"008004", 'ë‚¨í•´':"008005", 
                'ë°€ì–‘':"008007", 'ë¶€ì‚°':"008008", 'ì‚¬ì²œ':"008009", 'ì‚°ì²­':"008010", 'ì„œìƒ':"008024", 
                'ì–‘ì‚°':"008011", 'ìš¸ì‚°':"008012", 'ì˜ë ¹':"008013", 'ì§„ì£¼':"008014", 'ì°½ë…•':"008016", 
                'ì°½ì›':"008017", 'í†µì˜':"008018", 'í•˜ë™':"008019", 'í•˜ë™(ë‚´ë¥™)':"008020", 'í•¨ì•ˆ':"008021", 
                'í•¨ì–‘':"008022", 'í•©ì²œ':"008023",

                'ë…ë„':"009001", 'ìš¸ë¦‰ë„':"009002",

                'ê³ ì°½':"010001", 'êµ°ì‚°':"010002", 'ê¹€ì œ':"010003", 'ë‚¨ì›':"010004", 'ë¬´ì£¼':"010005", 
                'ë¶€ì•ˆ':"010006", 'ìˆœì°½':"010007", 'ì™„ì£¼':"010014", 'ìµì‚°':"010008", 'ì„ì‹¤':"010009", 
                'ì¥ìˆ˜':"010010", 'ì „ì£¼':"010011", 'ì •ì':"010012", 'ì§„ì•ˆ':"010013",

                'ê°•ì§„':"011001", 'ê³ í¥':"011002", 'ê³¡ì„±':"011003", 'ê´‘ì–‘':"011004", 'ê´‘ì£¼ê´‘ì—­ì‹œ':"011005", 
                'êµ¬ë¡€':"011006", 'ë‚˜ì£¼':"011007", 'ë‹´ì–‘':"011008", 'ëª©í¬':"011009", 'ë¬´ì•ˆ':"011010", 
                'ë³´ì„±':"011011", 'ìˆœì²œ':"011012", 'ì‹ ì•ˆ':"011013", 'ì—¬ìˆ˜':"011014", 'ì˜ê´‘':"011015", 
                'ì˜ì•”':"011016", 'ì™„ë„':"011017", 'ì¥ì„±':"011018", 'ì¥í¥':"011019", 'ì§„ë„':"011020", 
                'í•¨í‰':"011021", 'í•´ë‚¨':"011022", 'í™”ìˆœ':"011024", 'í‘ì‚°ë„':"011023",

                'ê³ ì‚°':"012001", 'ì„œê·€í¬':"012002", 'ì„±ì‚°í¬':"012003", 'ìœ—ì„¸ì˜¤ë¦„':"012004", 
                'ì œì£¼':"012005"
                }

    if area == "ê´‘ì£¼" :
        return ("ê´‘ì£¼ -> ê´‘ì£¼ì‹œ or ê´‘ì£¼ê´‘ì—­ì‹œ ë¡œ ê²€ìƒ‰í•´ì£¼ì„¸ìš”")
    if map_cityNum.get(area) == None:
        return area + "ëŠ” ë„ì‹œ ëª©ë¡ì— ì—†ìŠµë‹ˆë‹¤"
    else:
        cityNum = map_cityNum[area]
    addr = addr + cityNum

    session.encoding = 'utf-8'

    req = session.get(addr)
    soup = BeautifulSoup(req.text, "html.parser")
    table = soup.find(class_="card card_week")
    
    t_ary = list(table.stripped_strings)

    result = (
            "["+ area + " ë‚ ì”¨ ê²€ìƒ‰ ê²°ê³¼]\n"
            + "- ì˜¤ëŠ˜(" + t_ary[24] + ")\n"
            + "\tê°•ìˆ˜í™•ë¥  - ì˜¤ì „: " + t_ary[27] +" "+ add_emoji(t_ary[28]) + ", ì˜¤í›„: " + t_ary[31] +" "+ add_emoji(t_ary[32]) + "\n"
            + "\tìµœì €ê¸°ì˜¨: " + t_ary[34] + ", ìµœê³ ê¸°ì˜¨: " + t_ary[37] +"\n"
            + "- ë‚´ì¼(" + t_ary[39] + ")\n"
            + "\tê°•ìˆ˜í™•ë¥  - ì˜¤ì „: " + t_ary[42] +" "+ add_emoji(t_ary[43]) + ", ì˜¤í›„: " + t_ary[46] +" "+ add_emoji(t_ary[47]) + "\n"
            + "\tìµœì €ê¸°ì˜¨: " + t_ary[49] + ", ìµœê³ ê¸°ì˜¨: " + t_ary[52] +"\n"
            )
    return result

def rainday(area):
    '''
    return txt
    '''
    cityNum =""
    session = requests.Session() 
    addr = "https://weather.naver.com/today/"
    map_cityNum = {     # ì§€ì—­ ë²ˆí˜¸ ë§¤í•‘
                'ê°€í‰':"001001", 'ê°•í™”':"001002", 'ê³ ì–‘':"001003", 'ê³¼ì²œ':'001004','ê´‘ëª…':"001005" , 
                'ê´‘ì£¼ì‹œ':"001006", 'êµ¬ë¦¬':"001007", 'êµ°í¬':"001008", 'ê¹€í¬':"001009", 'ë‚¨ì–‘ì£¼':"001010",
                'ë™ë‘ì²œ':"001011", 'ë¬¸ì‚°':"001035", 'ë¶€ì²œ':"001012", 'ì„œìš¸':"001013", 'ì„±ë‚¨':'001014',
                'ìˆ˜ì›':"001015", 'ì‹œí¥':"001016", 'ì‹ ê°ˆ':"001034", 'ì•ˆì‚°':"001017", 'ì•ˆì„±':'001018',
                'ì•ˆì–‘':"001019", 'ì–‘ì£¼':"001020", 'ì–‘í‰':"001021", 'ì—¬ì£¼':"001036", 'ì—°ì²œ':"001022", 
                'ì˜¤ì‚°':"001023", 'ìš©ì¸':"001024", 'ì˜ì™•':"001025", 'ì˜ì •ë¶€':"001026", 'ì´ì²œ':"001027", 
                'ì¸ì²œ':"001028", 'íŒŒì£¼':"001029", 'í‰íƒ':"001030", 'í¬ì²œ':"001031", 'í•˜ë‚¨':"001032", 'í™”ì„±':"001033",

                'ë°±ë ¹ë„':"002001", 'ì†Œì²­ë„':"002002", 'ì—°í‰ë„':"002003",

                'ì–‘êµ¬':"003001", 'ì˜ì›”':"003002", 'ì›ì£¼':"003003", 'ì¸ì œ':"003004", 'ì •ì„ ':"003005", 
                'ì² ì›':"003006", 'ì¶˜ì²œ':"003007", 'í‰ì°½':"003008", 'í™ì²œ':"003009", 'í™”ì²œ':"003010", 
                'íš¡ê³„':"003012", 'íš¡ì„±':"003011",
                
                'ê°•ë¦‰':"004001", 'ê°•ì›':"004002", 'ì‚°ê°„':"004003", 'ê³ ì„±':"004004", 'ëŒ€ê´€ë ¹':"004005", 
                'ë™í•´':"004006", 'ì‚¼ì²™':"004007", 'ìƒˆë§':"004011", 'ì†ì´ˆ':"004007", 'ì–‘ì–‘':"004008", 
                'íƒœë°±':"004009",

                'ê´´ì‚°':"005001", 'ë‚¨ì´':"005013", 'ë‹¨ì–‘':"005002", 'ë³´ì€':"005003", 'ì˜ë™':"005004", 
                'ì˜¥ì²œ':"005005", 'ìŒì„±':"005006", 'ì œì²œ':"005007", 'ì¦í‰':"005008", 'ì§„ì²œ':"005009", 
                'ì²­ì›':"005014", 'ì²­ì£¼':"005010", 'ì¶”í’ë ¹':"005011", 'ì¶©ì£¼':"005012",

                'ê³„ë£¡':"006016", 'ê³µì£¼':"006001", 'ê¸ˆì‚°':"006002", 'ë…¼ì‚°':"006003", 'ë‹¹ì§„':"006004", 
                'ëŒ€ì „':"006005", 'ë³´ë ¹':"006006", 'ë¶€ì—¬':"006007", 'ì„œì‚°':"006008", 'ì„œì²œ':"006009", 
                'ì„¸ì¢…':"006017", 'ì•„ì‚°':"006010", 'ì˜ˆì‚°':"006011", 'ì²œì•ˆ':"006012", 'ì²­ì–‘':"006013", 
                'íƒœì•ˆ':"006014", 'í™ì„±':"006015",

                'ê²½ì‚°':"007001", 'ê²½ì£¼':"007002", 'ê³ ë ¹':"007003", 'êµ¬ë¯¸':"007004", 'êµ°ìœ„':"007005", 
                'ê¹€ì²œ':"007006", 'ëŒ€êµ¬':"007007", 'ë¬¸ê²½':"007008", 'ë´‰í™”':"007009", 'ìƒì£¼':"007010", 
                'ì„±ì£¼':"007011", 'ì•ˆë™':"007012", 'ì˜ë•':"007013", 'ì˜ì–‘':"007014", 'ì˜ì£¼':"007015", 
                'ì˜ì²œ':"007016", 'ì˜ˆì²œ':"007017", 'ìš¸ì§„':"007018", 'ì˜ì„±':"007019", 'ì²­ë„':"007020", 
                'ì²­ì†¡':"007021", 'ì¹ ê³¡':"007022", 'í¬í•­':"007023",

                'ê±°ì œ':"008001", 'ê±°ì°½':"008002", 'ê³ ì„±':"008003", 'ê¹€í•´':"008004", 'ë‚¨í•´':"008005", 
                'ë°€ì–‘':"008007", 'ë¶€ì‚°':"008008", 'ì‚¬ì²œ':"008009", 'ì‚°ì²­':"008010", 'ì„œìƒ':"008024", 
                'ì–‘ì‚°':"008011", 'ìš¸ì‚°':"008012", 'ì˜ë ¹':"008013", 'ì§„ì£¼':"008014", 'ì°½ë…•':"008016", 
                'ì°½ì›':"008017", 'í†µì˜':"008018", 'í•˜ë™':"008019", 'í•˜ë™(ë‚´ë¥™)':"008020", 'í•¨ì•ˆ':"008021", 
                'í•¨ì–‘':"008022", 'í•©ì²œ':"008023",

                'ë…ë„':"009001", 'ìš¸ë¦‰ë„':"009002",

                'ê³ ì°½':"010001", 'êµ°ì‚°':"010002", 'ê¹€ì œ':"010003", 'ë‚¨ì›':"010004", 'ë¬´ì£¼':"010005", 
                'ë¶€ì•ˆ':"010006", 'ìˆœì°½':"010007", 'ì™„ì£¼':"010014", 'ìµì‚°':"010008", 'ì„ì‹¤':"010009", 
                'ì¥ìˆ˜':"010010", 'ì „ì£¼':"010011", 'ì •ì':"010012", 'ì§„ì•ˆ':"010013",

                'ê°•ì§„':"011001", 'ê³ í¥':"011002", 'ê³¡ì„±':"011003", 'ê´‘ì–‘':"011004", 'ê´‘ì£¼ê´‘ì—­ì‹œ':"011005", 
                'êµ¬ë¡€':"011006", 'ë‚˜ì£¼':"011007", 'ë‹´ì–‘':"011008", 'ëª©í¬':"011009", 'ë¬´ì•ˆ':"011010", 
                'ë³´ì„±':"011011", 'ìˆœì²œ':"011012", 'ì‹ ì•ˆ':"011013", 'ì—¬ìˆ˜':"011014", 'ì˜ê´‘':"011015", 
                'ì˜ì•”':"011016", 'ì™„ë„':"011017", 'ì¥ì„±':"011018", 'ì¥í¥':"011019", 'ì§„ë„':"011020", 
                'í•¨í‰':"011021", 'í•´ë‚¨':"011022", 'í™”ìˆœ':"011024", 'í‘ì‚°ë„':"011023",

                'ê³ ì‚°':"012001", 'ì„œê·€í¬':"012002", 'ì„±ì‚°í¬':"012003", 'ìœ—ì„¸ì˜¤ë¦„':"012004", 
                'ì œì£¼':"012005"
                }

    if area == "ê´‘ì£¼" :
        return ("ê´‘ì£¼ -> ê´‘ì£¼ì‹œ or ê´‘ì£¼ê´‘ì—­ì‹œ ë¡œ ê²€ìƒ‰í•´ì£¼ì„¸ìš”")
    if map_cityNum.get(area) == None:
        return area + "ëŠ” ë„ì‹œ ëª©ë¡ì— ì—†ìŠµë‹ˆë‹¤"
    else:
        cityNum = map_cityNum[area]

    addr = addr + cityNum

    session.encoding = 'utf-8'

    req = session.get(addr)
    soup = BeautifulSoup(req.text, "html.parser")
    table = soup.find(class_="card card_week")
    
    t_ary = list(table.stripped_strings)
    # â˜€ï¸ ë§‘ìŒ ğŸŒ¤ â›…ï¸ êµ¬ë¦„ë§ìŒ ğŸŒ¥â˜ï¸ íë¦¼ ğŸŒ¦ êµ¬ë¦„ë§ê³  ë¹„ ğŸŒ§ ë¹„ â›ˆ ë²ˆê°œë¹„ ğŸŒ© ë²ˆê°œ ğŸŒ¨ â„ï¸ëˆˆ


    tmp = ""
    for i in range(len(t_ary)):
        if t_ary[i].find("ë¹„") >= 0 :
            if t_ary[i-3] == "ì˜¤í›„":
                tmp += (t_ary[i-8]  +"(" + t_ary[i-9]+ ") ì˜¤í›„ ê°•ìˆ˜í™•ë¥ : " + t_ary[i-1] + " " + add_emoji(t_ary[i]) +"\n")
            elif t_ary[i-3] == "ì˜¤ì „":
                tmp += (t_ary[i-5] +"(" + t_ary[i-4]+ ") ì˜¤ì „ ê°•ìˆ˜í™•ë¥ : " + t_ary[i-1] + " " + add_emoji(t_ary[i]) +"\n")

    return tmp
    
def add_emoji(txt):
    if txt == "ë§‘ìŒ":
        return txt+" â˜€ï¸"
    elif txt == "êµ¬ë¦„ë§ìŒ":
        return txt+ " â›…ï¸"
    elif txt == "íë¦¼":
        return txt+ " â˜ï¸"
    elif txt == "êµ¬ë¦„ë§ê³  ë¹„":
        return txt+ " ğŸŒ¦"
    elif txt == "ë¹„":
        return txt+ " ğŸŒ§"
    elif txt == "ë²ˆê°œë¹„":
        return txt+ " â›ˆ"
    elif txt == "ë²ˆê°œ":
        return txt+ " ğŸŒ©"
    elif txt == "ëˆˆ":
        return txt+ " â„ï¸"